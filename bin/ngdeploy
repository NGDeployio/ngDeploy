#! /usr/bin/env node
'use strict';

var program = require('commander')
    , ng    = require('../lib/cli')
    , pkg   = require('../package');

const chalk = require("chalk");

program
    .version(pkg.version)
    .usage('[command]');

program
    .option("-t,--test","Test mode that avoids ajax requests.");

program
    .command('init <appName> <dist>')
    .option("-a, --accessToken <key>","Set the access key")
    .description("Initialize ngdeploy with <appName> and <distribution folder>")
    .action(function(appName,dist,opts){
            ng.init(appName,dist,opts);
    });

program
    .command('create <appName>')
    .option("-a, --accesskey <key>","use the access key")
    .description("Create the app <appName>")
    .action(function(appName,opts){
        ng.create({ngDeployUrl: appName, name: appName},opts.accesskey);
    });


program
    .command('upload')
    .description('upload the distribution folder into the cloud. Take it away!')
    .action(ng.upload);

program
    .command('set')
    .option("-a, --accessToken <key>","Set the access key")
    .action(function(opts){
        ng.update(opts);
    });

program
    .command('delete <appname>')
    .option("-a, --accesskey <key>","use the access key")
    .description('delete an app from the server.')
    .action(function(args, opts){
        ng.delete(args, opts.accesskey);
    });

program
    .command('list')
    .option("-a, --accesskey <key>","use the access key")
    .description('list all of your apps')
    .action(function(opts){
        ng.list(opts.accesskey);
    });

program
    .command('clean')
    .description('remove configuration')
    .action(ng.clean);

program.on('--help', function(){
    ng.additional_help()
});

ng.readngdeploy();
program.parse(process.argv);

if(program.args.length==0)
        ng.usage();